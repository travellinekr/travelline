# Overnight Flight Logic Implementation

**날짜:** 2026-01-23  
**작업자:** AI + User

---

## 📋 작업 내용

### 문제점
기존 로직은 단순히 출발일과 귀국일의 날짜 차이만 계산하여 심야 출발/도착을 고려하지 못했습니다.

**예시:**
- 3/15(금) 23:00 출발 → 3/16(토) 01:00 도착
- 기존 계산: 3/15~3/18 = 4일
- 실제: 3/15~3/19 = 5일 (심야 귀국 시)

---

## 🔧 구현 내용

### 심야 출발/도착 로직

#### 계산 방식
```typescript
// 1. 출발일 (가는편 출발 날짜)
const tripStartDate = new Date(departureDate);

// 2. 귀국 도착일 계산
const tripEndDate = new Date(arrivalDate);
if (returnHour >= 23) {
    // 심야 출발(23:00~) → 다음날 도착으로 간주
    tripEndDate.setDate(tripEndDate.getDate() + 1);
}

// 3. 전체 일수 계산
const dayCount = Math.ceil(
    (tripEndDate - tripStartDate) / (1000 * 60 * 60 * 24)
) + 1;
```

---

## 📐 계산 예시

### 예시 1: 3박 5일 (심야 출발)
```
🛫 가는편: 3/15(금) 23:00 인천 출발
🛬 가는편: 3/16(토) 01:00 오사카 도착

🛫 오는편: 3/18(월) 23:00 오사카 출발
🛬 오는편: 3/19(화) 01:00 인천 도착

→ 출발일: 3/15
→ 도착일: 3/19 (23:00 출발이므로 +1일)
→ 전체: 5일
→ 숙박: 3박 (3/16, 3/17, 3/18)

생성 결과:
Day 0 (준비)
Day 1 (3/15 금) - 출발만
Day 2 (3/16 토) - 도착 + 숙박 1박
Day 3 (3/17 일) - 숙박 2박
Day 4 (3/18 월) - 숙박 3박 + 출발
Day 5 (3/19 화) - 도착만
```

### 예시 2: 3박 4일 (일반 귀국)
```
🛫 가는편: 3/15(금) 08:00 인천 출발
🛬 가는편: 3/15(금) 10:00 오사카 도착

🛫 오는편: 3/18(월) 18:00 오사카 출발
🛬 오는편: 3/18(월) 20:00 인천 도착

→ 출발일: 3/15
→ 도착일: 3/18 (18:00 출발, 같은 날 귀국)
→ 전체: 4일
→ 숙박: 3박 (3/15, 3/16, 3/17)

생성 결과:
Day 0 (준비)
Day 1 (3/15 금) - 도착 + 숙박 1박
Day 2 (3/16 토) - 숙박 2박
Day 3 (3/17 일) - 숙박 3박
Day 4 (3/18 월) - 출발 + 귀국
```

---

## 🎯 핵심 규칙

1. **심야 기준**: 23:00 이상 출발 시 다음날 도착으로 간주
2. **몇일**: 출발일 ~ 도착일 (달력 기준)
3. **몇박**: 현지 숙박 횟수 (호텔 체크인 수)

---

## 📝 수정된 파일

- `src/components/board/FlightSection.tsx`
  - `handleConfirm` 함수의 일차 계산 로직 수정
  - 심야 출발/도착을 고려한 `dayCount` 계산

---

## 🚀 향후 개선 사항

- [ ] 시차를 고려한 정확한 현지 도착 시간 계산
- [ ] 가는편 심야 출발도 고려 (현재는 귀국편만)
- [ ] UI에 몇박몇일 표시
